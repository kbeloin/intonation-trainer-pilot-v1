{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{makeStyles}from'@material-ui/core/styles';import Grid from'@material-ui/core/Grid';import Paper from'@material-ui/core/Paper';import Button from'@material-ui/core/Button';import Typography from'@material-ui/core/Typography';import{withRouter,NavLink}from'react-router-dom';import Recorder from'./Recorder.js';import Player from'./Player.js';import axios from'axios';import{processAudioData}from'../utils/processAudio.js';import{getPitchScatterData,resetCanvas,newPitchChart,newCanvas}from'./SoundChart.js';import{getCSRF}from'../utils/csrfHelper';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{content:{justifyContent:\"center\",display:\"flex\"},paper:{padding:theme.spacing(2),flexDirection:\"row\",minWidth:'100vw',minHeight:'80vh',display:\"flex-box\",elevation:3,alignItems:\"center\"},container:{position:'relative',height:'100%',justifyContent:\"center\"},button:{position:'absolute',bottom:'0',right:'0'},grid:{height:\"50%\",justifyContent:\"space-evenly\",spacing:\"0\",alignItems:\"flex-end\",direction:\"column\",minHeight:\"100%\"},chart:{justifyContent:\"space-evenly\",spacing:\"0\",alignItems:\"flex-end\",direction:\"column\",minHeight:\"40%\",marginBottom:\"1vh\",minWidth:\"35vw\"}};});var ProdTask=function ProdTask(props){var classes=useStyles();var _useState=useState(),_useState2=_slicedToArray(_useState,2),src=_useState2[0],setCurrentSrc=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),staged=_useState4[0],setStagedData=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),processedData=_useState6[0],setProcessedData=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),currentTask=_useState8[0],setTask=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),chartA=_useState10[0],setChartA=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),chartB=_useState12[0],setChartB=_useState12[1];var responseDataRef=useRef(null);var questionDataRef=useRef(null);var handleChange=function handleChange(){setCurrentSrc(staged);// console.log(src)\n};var processResponseAudioData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios({method:\"post\",url:\"/api/process/\",data:data,transformResponse:[function(data){console.log(data);//Transform the response data as you prefer\nreturn data;}]});case 2:response=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function processResponseAudioData(_x){return _ref.apply(this,arguments);};}();// const processResponseAudioData = (data) => {\n//     // Expects an array buffer, and returns converted pitch data. \n//     const newCanvas = resetCanvas('response-data', 'response-data-container')\n//     var xhr = new XMLHttpRequest()\n//     xhr.open(\"POST\", \"/api/process/\", true);\n//     xhr.setRequestHeader(\"X-CSRFToken\", getCSRF()); \n//     //Send the proper header information along with the request\n//     xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n//     xhr.onreadystatechange = function() { // Call a function when the state changes.\n//         if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n//             var response = JSON.parse(xhr.responseText);\n//             console.log(response)\n//             newPitchChart(newCanvas, getPitchScatterData(response))\n//             setProcessedData(response)\n//         }\n//     }  \n//     xhr.send(JSON.stringify(data))\n// }\nuseEffect(function(){// Update the document title using the browser AP\nif(src===undefined){console.log(\"No data recorded\");}else{processResponseAudioData(src);}},[src]);useEffect(function(){// Update the document title using the browser API (next action... taskType determines the element to show)\nif(processedData===null){console.log(\"No changes recorded\");}else{console.log(\"Processed data changed:\",processedData);}},[processedData]);useEffect(function(){var taskData=function taskData(){\"...\";};setChartA(newPitchChart(questionDataRef.current,[]));setChartB(newPitchChart(responseDataRef.current,[]));// Update the document title using the browser AP\n},[]);return/*#__PURE__*/_jsx(\"div\",{className:classes.content,children:/*#__PURE__*/_jsx(Paper,{className:classes.paper,children:/*#__PURE__*/_jsxs(Grid,{container:true,className:classes.grid,children:[/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Paper,{id:\"question-data-container\",className:classes.chart,children:/*#__PURE__*/_jsx(\"canvas\",{id:\"question-data\",ref:questionDataRef})}),/*#__PURE__*/_jsx(Player,{url:\"https://intonation-trainer.s3.us-east-2.amazonaws.com/test-audio.mp3\"})]}),/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Paper,{id:\"response-data-container\",className:classes.chart,children:/*#__PURE__*/_jsx(\"canvas\",{id:\"response-data\",ref:responseDataRef})}),/*#__PURE__*/_jsx(Recorder,{sets:setCurrentSrc})]}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:handleChange,children:\"Welcome\"})})]})})});};export default withRouter(ProdTask);","map":{"version":3,"sources":["/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/src/components/pages/ProductionTask.js"],"names":["React","useState","useEffect","useRef","makeStyles","Grid","Paper","Button","Typography","withRouter","NavLink","Recorder","Player","axios","processAudioData","getPitchScatterData","resetCanvas","newPitchChart","newCanvas","getCSRF","useStyles","theme","content","justifyContent","display","paper","padding","spacing","flexDirection","minWidth","minHeight","elevation","alignItems","container","position","height","button","bottom","right","grid","direction","chart","marginBottom","ProdTask","props","classes","src","setCurrentSrc","staged","setStagedData","processedData","setProcessedData","currentTask","setTask","chartA","setChartA","chartB","setChartB","responseDataRef","questionDataRef","handleChange","processResponseAudioData","data","method","url","transformResponse","console","log","response","undefined","taskData","current"],"mappings":"+hBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,MAArC,KAAmD,OAAnD,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,KAAP,KAAkB,yBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CAEA,OAASC,UAAT,CAAqBC,OAArB,KAAoC,kBAApC,CACA,MAAOC,CAAAA,QAAP,KAAqB,eAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,aAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,gBAAT,KAAiC,0BAAjC,CACA,OAASC,mBAAT,CAA8BC,WAA9B,CAA2CC,aAA3C,CAA0DC,SAA1D,KAA2E,iBAA3E,CACA,OAASC,OAAT,KAAwB,qBAAxB,C,wFAGA,GAAMC,CAAAA,SAAS,CAAGhB,UAAU,CAAC,SAACiB,KAAD,QAAY,CACvCC,OAAO,CAAE,CACPC,cAAc,CAAE,QADT,CAEPC,OAAO,CAAE,MAFF,CAD8B,CAKrCC,KAAK,CAAE,CACHC,OAAO,CAAEL,KAAK,CAACM,OAAN,CAAc,CAAd,CADN,CAEHC,aAAa,CAAE,KAFZ,CAGHC,QAAQ,CAAE,OAHP,CAIHC,SAAS,CAAE,MAJR,CAKHN,OAAO,CAAC,UALL,CAMHO,SAAS,CAAE,CANR,CAOHC,UAAU,CAAC,QAPR,CAL8B,CAcrCC,SAAS,CAAE,CACPC,QAAQ,CAAE,UADH,CAEPC,MAAM,CAAE,MAFD,CAGPZ,cAAc,CAAE,QAHT,CAd0B,CAmBrCa,MAAM,CAAE,CACJF,QAAQ,CAAE,UADN,CAEJG,MAAM,CAAC,GAFH,CAGJC,KAAK,CAAE,GAHH,CAnB6B,CAwBrCC,IAAI,CAAE,CACFJ,MAAM,CAAE,KADN,CAEFZ,cAAc,CAAC,cAFb,CAGFI,OAAO,CAAC,GAHN,CAIFK,UAAU,CAAC,UAJT,CAKFQ,SAAS,CAAC,QALR,CAMFV,SAAS,CAAC,MANR,CAxB+B,CAiCrCW,KAAK,CAAE,CACHlB,cAAc,CAAC,cADZ,CAEHI,OAAO,CAAC,GAFL,CAGHK,UAAU,CAAC,UAHR,CAIHQ,SAAS,CAAC,QAJP,CAKHV,SAAS,CAAC,KALP,CAMHY,YAAY,CAAE,KANX,CAOHb,QAAQ,CAAC,MAPN,CAjC8B,CAAZ,EAAD,CAA5B,CA4CA,GAAMc,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,KAAD,CAAW,CACxB,GAAMC,CAAAA,OAAO,CAAGzB,SAAS,EAAzB,CADwB,cAEGnB,QAAQ,EAFX,wCAEnB6C,GAFmB,eAEdC,aAFc,8BAGM9C,QAAQ,EAHd,yCAGnB+C,MAHmB,eAGXC,aAHW,8BAIgBhD,QAAQ,CAAC,IAAD,CAJxB,yCAInBiD,aAJmB,eAIJC,gBAJI,8BAKKlD,QAAQ,EALb,yCAKnBmD,WALmB,eAKNC,OALM,8BAOEpD,QAAQ,EAPV,0CAOnBqD,MAPmB,gBAOXC,SAPW,gCAQEtD,QAAQ,EARV,2CAQnBuD,MARmB,gBAQXC,SARW,gBAWxB,GAAMC,CAAAA,eAAe,CAAGvD,MAAM,CAAC,IAAD,CAA9B,CACA,GAAMwD,CAAAA,eAAe,CAAGxD,MAAM,CAAC,IAAD,CAA9B,CAEA,GAAMyD,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvBb,aAAa,CAACC,MAAD,CAAb,CAA0B;AAC7B,CAFD,CAGA,GAAMa,CAAAA,wBAAwB,0FAAG,iBAAOC,IAAP,qJACNjD,CAAAA,KAAK,CAAC,CACzBkD,MAAM,CAAE,MADiB,CAEzBC,GAAG,CAAE,eAFoB,CAGzBF,IAAI,CAAEA,IAHmB,CAIzBG,iBAAiB,CAAE,CAAC,SAACH,IAAD,CAAU,CAC1BI,OAAO,CAACC,GAAR,CAAYL,IAAZ,EAAkB;AAClB,MAAOA,CAAAA,IAAP,CACH,CAHkB,CAJM,CAAD,CADC,QACvBM,QADuB,qEAAH,kBAAxBP,CAAAA,wBAAwB,4CAA9B,CAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA3D,SAAS,CAAC,UAAM,CACZ;AACA,GAAI4C,GAAG,GAAKuB,SAAZ,CAAuB,CACnBH,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACH,CAFD,IAEO,CACPN,wBAAwB,CAACf,GAAD,CAAxB,CACH,CAAC,CANO,CAMN,CAACA,GAAD,CANM,CAAT,CAQA5C,SAAS,CAAC,UAAM,CACZ;AACA,GAAIgD,aAAa,GAAK,IAAtB,CAA4B,CACxBgB,OAAO,CAACC,GAAR,CAAY,qBAAZ,EACH,CAFD,IAEO,CACPD,OAAO,CAACC,GAAR,CAAY,yBAAZ,CAAuCjB,aAAvC,EAAsD,CACrD,CANI,CAMH,CAACA,aAAD,CANG,CAAT,CAQAhD,SAAS,CAAC,UAAM,CAEZ,GAAMoE,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACnB,MACH,CAFD,CAIAf,SAAS,CAACtC,aAAa,CAAC0C,eAAe,CAACY,OAAjB,CAA0B,EAA1B,CAAd,CAAT,CACAd,SAAS,CAACxC,aAAa,CAACyC,eAAe,CAACa,OAAjB,CAA0B,EAA1B,CAAd,CAAT,CACA;AACH,CATQ,CASP,EATO,CAAT,CAWA,mBACI,YAAK,SAAS,CAAE1B,OAAO,CAACvB,OAAxB,uBACI,KAAC,KAAD,EAAO,SAAS,CAAEuB,OAAO,CAACpB,KAA1B,uBACI,MAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAEoB,OAAO,CAACN,IAAnC,wBACI,MAAC,IAAD,EAAM,IAAI,KAAV,wBACI,KAAC,KAAD,EAAO,EAAE,CAAC,yBAAV,CAAoC,SAAS,CAAEM,OAAO,CAACJ,KAAvD,uBACI,eAAQ,EAAE,CAAC,eAAX,CAA2B,GAAG,CAAEkB,eAAhC,EADJ,EADJ,cAII,KAAC,MAAD,EAAQ,GAAG,CAAE,sEAAb,EAJJ,GADJ,cAOI,MAAC,IAAD,EAAM,IAAI,KAAV,wBACI,KAAC,KAAD,EAAO,EAAE,CAAC,yBAAV,CAAoC,SAAS,CAAEd,OAAO,CAACJ,KAAvD,uBACI,eAAQ,EAAE,CAAC,eAAX,CAA2B,GAAG,CAAEiB,eAAhC,EADJ,EADJ,cAII,KAAC,QAAD,EAAU,IAAI,CAAEX,aAAhB,EAJJ,GAPJ,cAaI,KAAC,IAAD,EAAM,IAAI,KAAV,uBACI,KAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,OAAO,CAAEa,YAApC,qBADJ,EAbJ,GADJ,EADJ,EADJ,CAuBC,CAnGL,CAoGA,cAAenD,CAAAA,UAAU,CAACkC,QAAD,CAAzB","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\nimport { withRouter, NavLink } from 'react-router-dom';\nimport Recorder from './Recorder.js'\nimport Player from './Player.js';\nimport axios from 'axios';\nimport { processAudioData } from '../utils/processAudio.js'\nimport { getPitchScatterData, resetCanvas, newPitchChart, newCanvas } from './SoundChart.js';\nimport { getCSRF } from '../utils/csrfHelper'\n\n\nconst useStyles = makeStyles((theme) => ({\n  content: {\n    justifyContent: \"center\",\n    display: \"flex\"\n  },\n    paper: {\n        padding: theme.spacing(2),\n        flexDirection: \"row\",\n        minWidth: '100vw',\n        minHeight: '80vh',\n        display:\"flex-box\",\n        elevation: 3,\n        alignItems:\"center\"\n    },\n    container: {\n        position: 'relative',\n        height: '100%',\n        justifyContent: \"center\"\n    },\n    button: {\n        position: 'absolute',\n        bottom:'0',\n        right: '0'\n    },\n    grid: {\n        height: \"50%\",\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"100%\"\n    },\n\n    chart: {\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"40%\",\n        marginBottom: \"1vh\",\n        minWidth:\"35vw\",\n    }\n}));\n\nconst ProdTask = (props) => {\n    const classes = useStyles();\n    let [src, setCurrentSrc] = useState()\n    let [staged, setStagedData] = useState()\n    let [processedData, setProcessedData] = useState(null)\n    let [currentTask, setTask] = useState()\n\n    let [chartA, setChartA] = useState()\n    let [chartB, setChartB] = useState()\n\n   \n    const responseDataRef = useRef(null);\n    const questionDataRef = useRef(null);\n    \n    const handleChange = () => {\n        setCurrentSrc(staged)     // console.log(src)\n    }\n    const processResponseAudioData = async (data) => {\n        const response = await axios({\n            method: \"post\",\n            url: \"/api/process/\",\n            data: data,\n            transformResponse: [(data) => {\n                console.log(data) //Transform the response data as you prefer\n                return data;\n            }]\n        });\n    }\n    \n    // const processResponseAudioData = (data) => {\n    //     // Expects an array buffer, and returns converted pitch data. \n    //     const newCanvas = resetCanvas('response-data', 'response-data-container')\n    //     var xhr = new XMLHttpRequest()\n    //     xhr.open(\"POST\", \"/api/process/\", true);\n    //     xhr.setRequestHeader(\"X-CSRFToken\", getCSRF()); \n    //     //Send the proper header information along with the request\n    //     xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n        \n    //     xhr.onreadystatechange = function() { // Call a function when the state changes.\n    //         if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n    //             var response = JSON.parse(xhr.responseText);\n    //             console.log(response)\n    //             newPitchChart(newCanvas, getPitchScatterData(response))\n    //             setProcessedData(response)\n    //         }\n    //     }  \n    //     xhr.send(JSON.stringify(data))\n    // }\n\n    useEffect(() => {\n        // Update the document title using the browser AP\n        if (src === undefined) { \n            console.log(\"No data recorded\") \n        } else {\n        processResponseAudioData(src)\n    }},[src]);\n\n    useEffect(() => {\n        // Update the document title using the browser API (next action... taskType determines the element to show)\n        if (processedData === null) { \n            console.log(\"No changes recorded\") \n        } else {\n        console.log(\"Processed data changed:\", processedData)}\n        },[processedData]);\n\n    useEffect(() => {\n\n        const taskData = () => {\n            \"...\"\n        }\n\n        setChartA(newPitchChart(questionDataRef.current, []))\n        setChartB(newPitchChart(responseDataRef.current, []))\n        // Update the document title using the browser AP\n    },[]);\n\n    return (\n        <div className={classes.content}>\n            <Paper className={classes.paper}>\n                <Grid container className={classes.grid}>\n                    <Grid item>\n                        <Paper id=\"question-data-container\" className={classes.chart}>  \n                            <canvas id=\"question-data\" ref={questionDataRef}></canvas>\n                        </Paper>\n                        <Player url={\"https://intonation-trainer.s3.us-east-2.amazonaws.com/test-audio.mp3\"}/>\n                    </Grid>\n                    <Grid item>\n                        <Paper id=\"response-data-container\" className={classes.chart}>\n                            <canvas id=\"response-data\" ref={responseDataRef}></canvas>\n                        </Paper>\n                        <Recorder sets={setCurrentSrc}/>\n                    </Grid>\n                    <Grid item>\n                        <Button variant=\"outlined\" onClick={handleChange}>Welcome</Button>\n                    </Grid>\n                </Grid>\n            </Paper>\n        </div>\n        );\n    }\nexport default withRouter(ProdTask)\n"]},"metadata":{},"sourceType":"module"}
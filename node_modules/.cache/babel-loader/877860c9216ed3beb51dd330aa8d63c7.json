{"ast":null,"code":"var _jsxFileName = \"/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/src/components/pages/ProductionTask.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { withRouter, NavLink } from 'react-router-dom';\nimport Recorder from './Recorder.js';\nimport Player from './Player.js';\nimport axios from 'axios';\nimport { processAudioData } from '../utils/processAudio.js';\nimport { getPitchScatterData, resetCanvas, newPitchChart, newCanvas } from './SoundChart.js';\nimport { getCSRF } from '../utils/csrfHelper';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  content: {\n    justifyContent: \"center\",\n    display: \"flex\"\n  },\n  paper: {\n    padding: theme.spacing(2),\n    flexDirection: \"row\",\n    minWidth: '100vw',\n    minHeight: '80vh',\n    display: \"flex-box\",\n    elevation: 3,\n    alignItems: \"center\"\n  },\n  container: {\n    position: 'relative',\n    height: '100%',\n    justifyContent: \"center\"\n  },\n  button: {\n    position: 'absolute',\n    bottom: '0',\n    right: '0'\n  },\n  grid: {\n    height: \"50%\",\n    justifyContent: \"space-evenly\",\n    spacing: \"0\",\n    alignItems: \"flex-end\",\n    direction: \"column\",\n    minHeight: \"100%\"\n  },\n  chart: {\n    justifyContent: \"space-evenly\",\n    spacing: \"0\",\n    alignItems: \"flex-end\",\n    direction: \"column\",\n    minHeight: \"40%\",\n    marginBottom: \"1vh\",\n    minWidth: \"35vw\"\n  }\n}));\n\nconst ProdTask = props => {\n  _s();\n\n  const classes = useStyles();\n  let [src, setCurrentSrc] = useState();\n  let [staged, setStagedData] = useState();\n  let [processedData, setProcessedData] = useState(null);\n  let [currentTask, setTask] = useState();\n  let [chartA, setChartA] = useState();\n  let [chartB, setChartB] = useState();\n  const responseDataRef = useRef(null);\n  const questionDataRef = useRef(null);\n\n  const handleChange = data => {\n    processAudioData(data).then();\n  }; // const processResponseAudioData = async (data) => {\n  //     const response = await axios({\n  //         method: \"post\",\n  //         url: \"/api/process/\",\n  //         data: data,\n  //         headers: {\"Content-Type\": \"application/octet-stream\"},\n  //         transformRequest: [(data) => {\n  //             console.log(data)\n  //             return JSON.stringify(data);\n  //         }],\n  //         transformResponse: [(data) => {\n  //             console.log(data) //Transform the response data as you prefer\n  //             return data;\n  //         }]\n  //     });\n  // }\n  // const processResponseAudioData = (data) => {\n  //     // Expects an array buffer, and returns converted pitch data. \n  //     const newCanvas = resetCanvas('response-data', 'response-data-container')\n  //     var xhr = new XMLHttpRequest()\n  //     xhr.open(\"POST\", \"/api/process/\", true);\n  //     xhr.setRequestHeader(\"X-CSRFToken\", getCSRF()); \n  //     //Send the proper header information along with the request\n  //     xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n  //     xhr.onreadystatechange = function() { // Call a function when the state changes.\n  //         if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n  //             var response = JSON.parse(xhr.responseText);\n  //             console.log(response)\n  //             newPitchChart(newCanvas, getPitchScatterData(response))\n  //             setProcessedData(response)\n  //         }\n  //     }  \n  //     xhr.send(JSON.stringify(data))\n  // }\n\n\n  useEffect(() => {\n    // Update the document title using the browser AP\n    if (src === undefined) {\n      console.log(\"No data recorded\");\n    } else {\n      processResponseAudioData(src);\n    }\n  }, [src]);\n  useEffect(() => {\n    // Update the document title using the browser API (next action... taskType determines the element to show)\n    if (processedData === null) {\n      console.log(\"No changes recorded\");\n    } else {\n      console.log(\"Processed data changed:\", processedData);\n    }\n  }, [processedData]);\n  useEffect(() => {\n    const taskData = () => {\n      \"...\";\n    };\n\n    setChartA(newPitchChart(questionDataRef.current, []));\n    setChartB(newPitchChart(responseDataRef.current, [])); // Update the document title using the browser AP\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.content,\n    children: /*#__PURE__*/_jsxDEV(Paper, {\n      className: classes.paper,\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        className: classes.grid,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          children: [/*#__PURE__*/_jsxDEV(Paper, {\n            id: \"question-data-container\",\n            className: classes.chart,\n            children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n              id: \"question-data\",\n              ref: questionDataRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Player, {\n            url: \"https://intonation-trainer.s3.us-east-2.amazonaws.com/test-audio.mp3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          children: [/*#__PURE__*/_jsxDEV(Paper, {\n            id: \"response-data-container\",\n            className: classes.chart,\n            children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n              id: \"response-data\",\n              ref: responseDataRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Recorder, {\n            sets: setCurrentSrc\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outlined\",\n            onClick: handleChange,\n            children: \"Welcome\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProdTask, \"q2NUXR29HCV52h4mw3/UbGHAb1I=\", false, function () {\n  return [useStyles];\n});\n\n_c = ProdTask;\nexport default _c2 = withRouter(ProdTask);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ProdTask\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/src/components/pages/ProductionTask.js"],"names":["React","useState","useEffect","useRef","makeStyles","Grid","Paper","Button","Typography","withRouter","NavLink","Recorder","Player","axios","processAudioData","getPitchScatterData","resetCanvas","newPitchChart","newCanvas","getCSRF","useStyles","theme","content","justifyContent","display","paper","padding","spacing","flexDirection","minWidth","minHeight","elevation","alignItems","container","position","height","button","bottom","right","grid","direction","chart","marginBottom","ProdTask","props","classes","src","setCurrentSrc","staged","setStagedData","processedData","setProcessedData","currentTask","setTask","chartA","setChartA","chartB","setChartB","responseDataRef","questionDataRef","handleChange","data","then","undefined","console","log","processResponseAudioData","taskData","current"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\nimport { withRouter, NavLink } from 'react-router-dom';\nimport Recorder from './Recorder.js'\nimport Player from './Player.js';\nimport axios from 'axios';\nimport { processAudioData } from '../utils/processAudio.js'\nimport { getPitchScatterData, resetCanvas, newPitchChart, newCanvas } from './SoundChart.js';\nimport { getCSRF } from '../utils/csrfHelper'\n\n\nconst useStyles = makeStyles((theme) => ({\n  content: {\n    justifyContent: \"center\",\n    display: \"flex\"\n  },\n    paper: {\n        padding: theme.spacing(2),\n        flexDirection: \"row\",\n        minWidth: '100vw',\n        minHeight: '80vh',\n        display:\"flex-box\",\n        elevation: 3,\n        alignItems:\"center\"\n    },\n    container: {\n        position: 'relative',\n        height: '100%',\n        justifyContent: \"center\"\n    },\n    button: {\n        position: 'absolute',\n        bottom:'0',\n        right: '0'\n    },\n    grid: {\n        height: \"50%\",\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"100%\"\n    },\n\n    chart: {\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"40%\",\n        marginBottom: \"1vh\",\n        minWidth:\"35vw\",\n    }\n}));\n\nconst ProdTask = (props) => {\n    const classes = useStyles();\n    let [src, setCurrentSrc] = useState()\n    let [staged, setStagedData] = useState()\n    let [processedData, setProcessedData] = useState(null)\n    let [currentTask, setTask] = useState()\n\n    let [chartA, setChartA] = useState()\n    let [chartB, setChartB] = useState()\n\n   \n    const responseDataRef = useRef(null);\n    const questionDataRef = useRef(null);\n    \n    const handleChange = (data) => {\n        processAudioData(data).then()\n\n    }\n    // const processResponseAudioData = async (data) => {\n    //     const response = await axios({\n    //         method: \"post\",\n    //         url: \"/api/process/\",\n    //         data: data,\n    //         headers: {\"Content-Type\": \"application/octet-stream\"},\n    //         transformRequest: [(data) => {\n    //             console.log(data)\n    //             return JSON.stringify(data);\n    //         }],\n    //         transformResponse: [(data) => {\n    //             console.log(data) //Transform the response data as you prefer\n    //             return data;\n    //         }]\n    //     });\n    // }\n    \n    // const processResponseAudioData = (data) => {\n    //     // Expects an array buffer, and returns converted pitch data. \n    //     const newCanvas = resetCanvas('response-data', 'response-data-container')\n    //     var xhr = new XMLHttpRequest()\n    //     xhr.open(\"POST\", \"/api/process/\", true);\n    //     xhr.setRequestHeader(\"X-CSRFToken\", getCSRF()); \n    //     //Send the proper header information along with the request\n    //     xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n        \n    //     xhr.onreadystatechange = function() { // Call a function when the state changes.\n    //         if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n    //             var response = JSON.parse(xhr.responseText);\n    //             console.log(response)\n    //             newPitchChart(newCanvas, getPitchScatterData(response))\n    //             setProcessedData(response)\n    //         }\n    //     }  \n    //     xhr.send(JSON.stringify(data))\n    // }\n\n    useEffect(() => {\n        // Update the document title using the browser AP\n        if (src === undefined) { \n            console.log(\"No data recorded\") \n        } else {\n        processResponseAudioData(src)\n    }},[src]);\n\n    useEffect(() => {\n        // Update the document title using the browser API (next action... taskType determines the element to show)\n        if (processedData === null) { \n            console.log(\"No changes recorded\") \n        } else {\n        console.log(\"Processed data changed:\", processedData)}\n        },[processedData]);\n\n    useEffect(() => {\n\n        const taskData = () => {\n            \"...\"\n        }\n\n        setChartA(newPitchChart(questionDataRef.current, []))\n        setChartB(newPitchChart(responseDataRef.current, []))\n        // Update the document title using the browser AP\n    },[]);\n\n    return (\n        <div className={classes.content}>\n            <Paper className={classes.paper}>\n                <Grid container className={classes.grid}>\n                    <Grid item>\n                        <Paper id=\"question-data-container\" className={classes.chart}>  \n                            <canvas id=\"question-data\" ref={questionDataRef}></canvas>\n                        </Paper>\n                        <Player url={\"https://intonation-trainer.s3.us-east-2.amazonaws.com/test-audio.mp3\"}/>\n                    </Grid>\n                    <Grid item>\n                        <Paper id=\"response-data-container\" className={classes.chart}>\n                            <canvas id=\"response-data\" ref={responseDataRef}></canvas>\n                        </Paper>\n                        <Recorder sets={setCurrentSrc}/>\n                    </Grid>\n                    <Grid item>\n                        <Button variant=\"outlined\" onClick={handleChange}>Welcome</Button>\n                    </Grid>\n                </Grid>\n            </Paper>\n        </div>\n        );\n    }\nexport default withRouter(ProdTask)\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _slicedToArray from\"/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{makeStyles}from'@material-ui/core/styles';import Grid from'@material-ui/core/Grid';import Paper from'@material-ui/core/Paper';import Button from'@material-ui/core/Button';import Typography from'@material-ui/core/Typography';import Container from'@material-ui/core/Container';import{withRouter,NavLink}from'react-router-dom';import Recorder from'./Recorder.js';import Player from'./Player.js';import axios from\"axios\";import{Scatter}from'react-chartjs-2';import{newChart,updateChart,getData}from'./SoundChart.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{content:{justifyContent:\"center\",display:\"flex\"},paper:{padding:theme.spacing(2),flexDirection:\"row\",minWidth:'100vw',minHeight:'80vh',display:\"flex-box\",elevation:3,alignItems:\"center\"},container:{position:'relative',height:'100%',justifyContent:\"center\"},button:{position:'absolute',bottom:'0',right:'0'},grid:{height:\"50%\",justifyContent:\"space-evenly\",spacing:\"0\",alignItems:\"flex-end\",direction:\"column\",minHeight:\"100%\"},chart:{justifyContent:\"space-evenly\",spacing:\"0\",alignItems:\"flex-end\",direction:\"column\",minHeight:\"40%\",marginBottom:\"1vh\",minWidth:\"35vw\"}};});var getCSRF=function getCSRF(){try{var token=document.cookie.split('; ').find(function(row){return row.startsWith('csrftoken=');}).split('=')[1];return token;}catch(e){console.log(e);}};var uploadFile=function uploadFile(file,s3Data,url){var xhr=new XMLHttpRequest();xhr.open(\"POST\",url);console.log(s3Data);var postData=new FormData();var fields=s3Data.fields;console.log(fields);Object.entries(s3Data).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];return xhr.setRequestHeader(key,value);});postData.append('file',file);xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200||xhr.status===204){var response=JSON.parse(xhr.responseText);console.log(response);}else{alert(\"Could not upload file.\");}}};console.log(file);xhr.send(postData);};var getSignedRequest=function getSignedRequest(file){var xhr=new XMLHttpRequest();xhr.open(\"GET\",\"/api/sign_s3\");xhr.setRequestHeader(\"X-CSRFToken\",getCSRF());xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200){var response=JSON.parse(xhr.responseText);console.log(response);uploadFile(file,response.data,response.url);}else{alert(\"Could not get signed URL.\");}}};xhr.send();};var ProdTask=function ProdTask(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),src=_useState2[0],setCurrentSrc=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),staged=_useState4[0],setStagedData=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),processedData=_useState6[0],setProcessedData=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),chartA=_useState8[0],setChartA=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),chartB=_useState10[0],setChartB=_useState10[1];var classes=useStyles();var responseDataRef=useRef(null);var questionDataRef=useRef(null);var handleChange=function handleChange(){var audio=staged;// document.getElementById(\"recorder\").currentSrc\nsetCurrentSrc(staged);// console.log(src)\n};var processData=function processData(data){console.log(staged);document.getElementById('responseData').remove();var newCanvas=document.createElement('canvas');newCanvas.setAttribute('id','responseData');document.getElementById('responseDataContainer').append(newCanvas);var xhr=new XMLHttpRequest();xhr.open(\"POST\",\"/api/process/\",true);xhr.setRequestHeader(\"X-CSRFToken\",getCSRF());//Send the proper header information along with the request\nxhr.setRequestHeader(\"Content-Type\",\"application/octet-stream\");xhr.onreadystatechange=function(){// Call a function when the state changes.\nif(this.readyState===XMLHttpRequest.DONE&&this.status===200){var response=JSON.parse(xhr.responseText);newChart(newCanvas,getData(response));setProcessedData(response);}};xhr.send(JSON.stringify(data));};// useEffect(() => {\n//     // Update the document title using the browser API\n//     src === undefined ? console.log(\"None\") : processData(src)},[src]);\nuseEffect(function(){// Update the document title using the browser AP\nsrc===undefined?console.log(\"None\"):processData(src);},[src]);useEffect(function(){// Update the document title using the browser API\nconsole.log(processedData);},[processedData]);useEffect(function(){setChartA(newChart(questionDataRef.current,[]));setChartB(newChart(responseDataRef.current,[]));// Update the document title using the browser AP\n},[]);return/*#__PURE__*/_jsx(\"div\",{className:classes.content,children:/*#__PURE__*/_jsx(Paper,{className:classes.paper,children:/*#__PURE__*/_jsxs(Grid,{container:true,className:classes.grid,children:[/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Paper,{className:classes.chart,children:/*#__PURE__*/_jsx(\"canvas\",{id:\"questionData\",ref:questionDataRef})}),/*#__PURE__*/_jsx(Player,{})]}),/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Paper,{id:\"responseDataContainer\",className:classes.chart,children:/*#__PURE__*/_jsx(\"canvas\",{id:\"responseData\",ref:responseDataRef})}),/*#__PURE__*/_jsx(Recorder,{sets:setStagedData})]}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:handleChange,children:\"Welcome\"})})]})})});};export default withRouter(ProdTask);","map":{"version":3,"sources":["/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/src/components/pages/ProductionTask.js"],"names":["React","useState","useEffect","useRef","makeStyles","Grid","Paper","Button","Typography","Container","withRouter","NavLink","Recorder","Player","axios","Scatter","newChart","updateChart","getData","useStyles","theme","content","justifyContent","display","paper","padding","spacing","flexDirection","minWidth","minHeight","elevation","alignItems","container","position","height","button","bottom","right","grid","direction","chart","marginBottom","getCSRF","token","document","cookie","split","find","row","startsWith","e","console","log","uploadFile","file","s3Data","url","xhr","XMLHttpRequest","open","postData","FormData","fields","Object","entries","forEach","key","value","setRequestHeader","append","onreadystatechange","readyState","status","response","JSON","parse","responseText","alert","send","getSignedRequest","data","ProdTask","props","src","setCurrentSrc","staged","setStagedData","processedData","setProcessedData","chartA","setChartA","chartB","setChartB","classes","responseDataRef","questionDataRef","handleChange","audio","processData","getElementById","remove","newCanvas","createElement","setAttribute","DONE","stringify","undefined","current"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Container from '@material-ui/core/Container'\nimport { withRouter, NavLink } from 'react-router-dom';\nimport Recorder from './Recorder.js'\nimport Player from './Player.js';\nimport axios from \"axios\";\nimport { Scatter} from 'react-chartjs-2'\nimport { newChart, updateChart, getData } from './SoundChart.js';\n\nconst useStyles = makeStyles((theme) => ({\n  content: {\n    justifyContent: \"center\",\n    display: \"flex\"\n  },\n    paper: {\n        padding: theme.spacing(2),\n        flexDirection: \"row\",\n        minWidth: '100vw',\n        minHeight: '80vh',\n        display:\"flex-box\",\n        elevation: 3,\n        alignItems:\"center\"\n    },\n    container: {\n        position: 'relative',\n        height: '100%',\n        justifyContent: \"center\"\n    },\n    button: {\n        position: 'absolute',\n        bottom:'0',\n        right: '0'\n    },\n    grid: {\n        height: \"50%\",\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"100%\"\n    },\n\n    chart: {\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"40%\",\n        marginBottom: \"1vh\",\n        minWidth:\"35vw\",\n    }\n}));\n\nconst getCSRF = () => {\n    try {\n    const token = document.cookie\n        .split('; ')\n        .find(row => row.startsWith('csrftoken='))\n        .split('=')[1]\n    return token\n    } catch (e) {console.log(e)}\n}\n\nconst uploadFile = (file, s3Data, url) => {\n    var xhr = new XMLHttpRequest();\n    xhr.open(\"POST\",url);\n    console.log(s3Data)\n    var postData = new FormData();\n    var fields = s3Data.fields\n    console.log(fields)\n    Object.entries(s3Data).forEach(([key, value]) => \n    xhr.setRequestHeader(key, value));\n\n    postData.append('file', file);\n  \n    xhr.onreadystatechange = function() {\n      if(xhr.readyState === 4){\n        if(xhr.status === 200 || xhr.status === 204){\n            var response = JSON.parse(xhr.responseText);\n            console.log(response)\n        }\n        else{\n          alert(\"Could not upload file.\");\n        }\n     }\n    };\n    console.log(file)\n    xhr.send(postData);\n  }\n\n\nconst getSignedRequest = (file) => {\n    \n    var xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", \"/api/sign_s3\");\n    xhr.setRequestHeader(\"X-CSRFToken\", getCSRF());\n    xhr.onreadystatechange = function(){\n        if(xhr.readyState === 4){\n        if(xhr.status === 200){\n            var response = JSON.parse(xhr.responseText);\n            console.log(response)\n            uploadFile(file, response.data, response.url);\n        }\n        else{\n            alert(\"Could not get signed URL.\");\n        }\n        }\n    };\n    xhr.send();\n    }\n\n\n\nconst ProdTask = (props) => {\n    let [src, setCurrentSrc] = useState()\n    let [staged, setStagedData] = useState()\n    let [processedData, setProcessedData] = useState(null)\n    let [chartA, setChartA] = useState()\n    let [chartB, setChartB] = useState()\n    const classes = useStyles();\n    const responseDataRef = useRef(null);\n    const questionDataRef = useRef(null);\n    \n    \n\n    const handleChange = () => {\n        let audio = staged\n        \n        // document.getElementById(\"recorder\").currentSrc\n        setCurrentSrc(staged)     // console.log(src)\n    }\n    \n    const processData = (data) => {\n        console.log(staged)\n        document.getElementById('responseData').remove()\n        const newCanvas = document.createElement('canvas')\n        newCanvas.setAttribute('id', 'responseData')\n        \n        document.getElementById('responseDataContainer').append(newCanvas)\n\n        var xhr = new XMLHttpRequest()\n        xhr.open(\"POST\", \"/api/process/\", true);\n        xhr.setRequestHeader(\"X-CSRFToken\", getCSRF());\n        //Send the proper header information along with the request\n        xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n    \n        \n        xhr.onreadystatechange = function() { // Call a function when the state changes.\n            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n                var response = JSON.parse(xhr.responseText);\n                newChart(newCanvas, getData(response))\n                setProcessedData(response)\n                \n            }\n        }\n        \n        xhr.send(JSON.stringify(data))\n    \n    }\n    // useEffect(() => {\n    //     // Update the document title using the browser API\n        \n    //     src === undefined ? console.log(\"None\") : processData(src)},[src]);\n    \n    useEffect(() => {\n        // Update the document title using the browser AP\n        src === undefined ? console.log(\"None\") : processData(src)},[src]);\n\n    useEffect(() => {\n            // Update the document title using the browser API\n        \n        console.log(processedData)\n    },[processedData]);\n\n    useEffect(() => {\n        setChartA(newChart(questionDataRef.current, []))\n        setChartB(newChart(responseDataRef.current, []))\n        // Update the document title using the browser AP\n},[]);\n    \n\n    \n    return (\n        <div className={classes.content}>\n            <Paper className={classes.paper}>\n                <Grid container className={classes.grid}>\n                    <Grid item>\n                        <Paper className={classes.chart}>  \n                            <canvas id=\"questionData\" ref={questionDataRef}></canvas>\n                        </Paper>\n                        <Player/>\n                    </Grid>\n                    <Grid item>\n                        <Paper id=\"responseDataContainer\" className={classes.chart}>\n                            <canvas id=\"responseData\" ref={responseDataRef}></canvas>\n                        </Paper>\n                        <Recorder sets={setStagedData}/>\n                    </Grid>\n                    <Grid item>\n                        <Button variant=\"outlined\" onClick={handleChange}>Welcome</Button>\n                    </Grid>\n                </Grid>\n            </Paper>\n        </div>\n        );\n    }\nexport default withRouter(ProdTask)\n"]},"metadata":{},"sourceType":"module"}
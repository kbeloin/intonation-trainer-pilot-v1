{"ast":null,"code":"import _slicedToArray from\"/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{makeStyles}from'@material-ui/core/styles';import Grid from'@material-ui/core/Grid';import Paper from'@material-ui/core/Paper';import Button from'@material-ui/core/Button';import Typography from'@material-ui/core/Typography';import{withRouter,NavLink}from'react-router-dom';import Recorder from'./Recorder.js';import Player from'./Player.js';import axios from'axios';import{processAudioData}from'../utils/processAudio.js';import{submitResponse}from'../utils/submitResponse.js';import{getPitchScatterData,resetCanvas,newPitchChart,newCanvas}from'./SoundChart.js';import{getCSRF}from'../utils/csrfHelper';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{content:{justifyContent:\"center\",display:\"flex\"},paper:{padding:theme.spacing(2),flexDirection:\"row\",minWidth:'100vw',minHeight:'80vh',display:\"flex-box\",elevation:3,alignItems:\"center\"},container:{position:'relative',height:'100%',justifyContent:\"center\"},button:{position:'absolute',bottom:'0',right:'0'},grid:{height:\"50%\",justifyContent:\"space-evenly\",spacing:\"0\",alignItems:\"flex-end\",direction:\"column\",minHeight:\"100%\"},chart:{justifyContent:\"space-evenly\",spacing:\"0\",alignItems:\"flex-end\",direction:\"column\",minHeight:\"40%\",marginBottom:\"1vh\",minWidth:\"35vw\"}};});var ProdTask=function ProdTask(props){var classes=useStyles();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),processedData=_useState2[0],setProcessedData=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),taskData=_useState4[0],setTaskData=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),chartA=_useState6[0],setChartA=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),chartB=_useState8[0],setChartB=_useState8[1];var responseDataRef=useRef(null);var questionDataRef=useRef(null);var handleAudioChange=function handleAudioChange(data){var newCanvas=resetCanvas('response-data','response-data-container',chartB);processAudioData(data).then(function(response){var pitchData=getPitchScatterData(response.data);setChartB(newPitchChart(newCanvas,pitchData,chartB));// Destroys chart / resets element\nsetProcessedData(pitchData);});};var nextTask=function nextTask(){var response={'taskData':taskData,'responseData':processedData};submitResponse();};useEffect(function(){// Update the document title using the browser API (next action... taskType determines the element to show)\nif(processedData===null){console.log(\"No changes recorded\");}else{console.log(\"Processed data changed:\",processedData);}},[processedData]);useEffect(function(){setChartA(newPitchChart(questionDataRef.current,[]));setChartB(newPitchChart(responseDataRef.current,[]));},[]);return/*#__PURE__*/_jsx(\"div\",{className:classes.content,children:/*#__PURE__*/_jsx(Paper,{className:classes.paper,children:/*#__PURE__*/_jsxs(Grid,{container:true,className:classes.grid,children:[/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Paper,{id:\"question-data-container\",className:classes.chart,children:/*#__PURE__*/_jsx(\"canvas\",{id:\"question-data\",ref:questionDataRef})}),/*#__PURE__*/_jsx(Player,{url:\"https://intonation-trainer.s3.us-east-2.amazonaws.com/test-audio.mp3\"})]}),/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Paper,{id:\"response-data-container\",className:classes.chart,children:/*#__PURE__*/_jsx(\"canvas\",{id:\"response-data\",ref:responseDataRef})}),/*#__PURE__*/_jsx(Recorder,{sets:handleAudioChange})]}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:nextTask,children:\"Welcome\"})})]})})});};export default withRouter(ProdTask);","map":{"version":3,"sources":["/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/src/components/pages/ProductionTask.js"],"names":["React","useState","useEffect","useRef","makeStyles","Grid","Paper","Button","Typography","withRouter","NavLink","Recorder","Player","axios","processAudioData","submitResponse","getPitchScatterData","resetCanvas","newPitchChart","newCanvas","getCSRF","useStyles","theme","content","justifyContent","display","paper","padding","spacing","flexDirection","minWidth","minHeight","elevation","alignItems","container","position","height","button","bottom","right","grid","direction","chart","marginBottom","ProdTask","props","classes","processedData","setProcessedData","taskData","setTaskData","chartA","setChartA","chartB","setChartB","responseDataRef","questionDataRef","handleAudioChange","data","then","response","pitchData","nextTask","console","log","current"],"mappings":"sLAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,MAArC,KAAmD,OAAnD,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,KAAP,KAAkB,yBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CAEA,OAASC,UAAT,CAAqBC,OAArB,KAAoC,kBAApC,CACA,MAAOC,CAAAA,QAAP,KAAqB,eAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,aAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,gBAAT,KAAiC,0BAAjC,CACA,OAASC,cAAT,KAA+B,4BAA/B,CACA,OAASC,mBAAT,CAA8BC,WAA9B,CAA2CC,aAA3C,CAA0DC,SAA1D,KAA2E,iBAA3E,CACA,OAASC,OAAT,KAAwB,qBAAxB,C,wFAEA,GAAMC,CAAAA,SAAS,CAAGjB,UAAU,CAAC,SAACkB,KAAD,QAAY,CACvCC,OAAO,CAAE,CACPC,cAAc,CAAE,QADT,CAEPC,OAAO,CAAE,MAFF,CAD8B,CAKrCC,KAAK,CAAE,CACHC,OAAO,CAAEL,KAAK,CAACM,OAAN,CAAc,CAAd,CADN,CAEHC,aAAa,CAAE,KAFZ,CAGHC,QAAQ,CAAE,OAHP,CAIHC,SAAS,CAAE,MAJR,CAKHN,OAAO,CAAC,UALL,CAMHO,SAAS,CAAE,CANR,CAOHC,UAAU,CAAC,QAPR,CAL8B,CAcrCC,SAAS,CAAE,CACPC,QAAQ,CAAE,UADH,CAEPC,MAAM,CAAE,MAFD,CAGPZ,cAAc,CAAE,QAHT,CAd0B,CAmBrCa,MAAM,CAAE,CACJF,QAAQ,CAAE,UADN,CAEJG,MAAM,CAAC,GAFH,CAGJC,KAAK,CAAE,GAHH,CAnB6B,CAwBrCC,IAAI,CAAE,CACFJ,MAAM,CAAE,KADN,CAEFZ,cAAc,CAAC,cAFb,CAGFI,OAAO,CAAC,GAHN,CAIFK,UAAU,CAAC,UAJT,CAKFQ,SAAS,CAAC,QALR,CAMFV,SAAS,CAAC,MANR,CAxB+B,CAiCrCW,KAAK,CAAE,CACHlB,cAAc,CAAC,cADZ,CAEHI,OAAO,CAAC,GAFL,CAGHK,UAAU,CAAC,UAHR,CAIHQ,SAAS,CAAC,QAJP,CAKHV,SAAS,CAAC,KALP,CAMHY,YAAY,CAAE,KANX,CAOHb,QAAQ,CAAC,MAPN,CAjC8B,CAAZ,EAAD,CAA5B,CA4CA,GAAMc,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,KAAD,CAAW,CACxB,GAAMC,CAAAA,OAAO,CAAGzB,SAAS,EAAzB,CADwB,cAEgBpB,QAAQ,CAAC,IAAD,CAFxB,wCAEnB8C,aAFmB,eAEJC,gBAFI,8BAGM/C,QAAQ,EAHd,yCAGnBgD,QAHmB,eAGTC,WAHS,8BAKEjD,QAAQ,EALV,yCAKnBkD,MALmB,eAKXC,SALW,8BAMEnD,QAAQ,EANV,yCAMnBoD,MANmB,eAMXC,SANW,eAQxB,GAAIC,CAAAA,eAAe,CAAGpD,MAAM,CAAC,IAAD,CAA5B,CACA,GAAIqD,CAAAA,eAAe,CAAGrD,MAAM,CAAC,IAAD,CAA5B,CAEA,GAAIsD,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,IAAD,CAAU,CAC9B,GAAIvC,CAAAA,SAAS,CAAGF,WAAW,CAAC,eAAD,CAAkB,yBAAlB,CAA6CoC,MAA7C,CAA3B,CACAvC,gBAAgB,CAAC4C,IAAD,CAAhB,CAAuBC,IAAvB,CAA4B,SAACC,QAAD,CAAc,CACtC,GAAIC,CAAAA,SAAS,CAAG7C,mBAAmB,CAAC4C,QAAQ,CAACF,IAAV,CAAnC,CACAJ,SAAS,CAACpC,aAAa,CAACC,SAAD,CAAY0C,SAAZ,CAAuBR,MAAvB,CAAd,CAAT,CAAuD;AACvDL,gBAAgB,CAACa,SAAD,CAAhB,CACF,CAJF,EAKH,CAPD,CASA,GAAIC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CAEjB,GAAIF,CAAAA,QAAQ,CAAG,CAAE,WAAYX,QAAd,CAAwB,eAAgBF,aAAxC,CAAf,CACAhC,cAAc,GACjB,CAJD,CAMAb,SAAS,CAAC,UAAM,CACZ;AACA,GAAI6C,aAAa,GAAK,IAAtB,CAA4B,CACxBgB,OAAO,CAACC,GAAR,CAAY,qBAAZ,EACH,CAFD,IAEO,CACPD,OAAO,CAACC,GAAR,CAAY,yBAAZ,CAAuCjB,aAAvC,EAAsD,CACrD,CANI,CAMH,CAACA,aAAD,CANG,CAAT,CAQA7C,SAAS,CAAC,UAAM,CACZkD,SAAS,CAAClC,aAAa,CAACsC,eAAe,CAACS,OAAjB,CAA0B,EAA1B,CAAd,CAAT,CACAX,SAAS,CAACpC,aAAa,CAACqC,eAAe,CAACU,OAAjB,CAA0B,EAA1B,CAAd,CAAT,CACH,CAHQ,CAGP,EAHO,CAAT,CAKA,mBACI,YAAK,SAAS,CAAEnB,OAAO,CAACvB,OAAxB,uBACI,KAAC,KAAD,EAAO,SAAS,CAAEuB,OAAO,CAACpB,KAA1B,uBACI,MAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAEoB,OAAO,CAACN,IAAnC,wBACI,MAAC,IAAD,EAAM,IAAI,KAAV,wBACI,KAAC,KAAD,EAAO,EAAE,CAAC,yBAAV,CAAoC,SAAS,CAAEM,OAAO,CAACJ,KAAvD,uBACI,eAAQ,EAAE,CAAC,eAAX,CAA2B,GAAG,CAAEc,eAAhC,EADJ,EADJ,cAII,KAAC,MAAD,EAAQ,GAAG,CAAE,sEAAb,EAJJ,GADJ,cAOI,MAAC,IAAD,EAAM,IAAI,KAAV,wBACI,KAAC,KAAD,EAAO,EAAE,CAAC,yBAAV,CAAoC,SAAS,CAAEV,OAAO,CAACJ,KAAvD,uBACI,eAAQ,EAAE,CAAC,eAAX,CAA2B,GAAG,CAAEa,eAAhC,EADJ,EADJ,cAII,KAAC,QAAD,EAAU,IAAI,CAAEE,iBAAhB,EAJJ,GAPJ,cAaI,KAAC,IAAD,EAAM,IAAI,KAAV,uBACI,KAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,OAAO,CAAEK,QAApC,qBADJ,EAbJ,GADJ,EADJ,EADJ,CAuBC,CA9DL,CAgEA,cAAerD,CAAAA,UAAU,CAACmC,QAAD,CAAzB","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\nimport { withRouter, NavLink } from 'react-router-dom';\nimport Recorder from './Recorder.js'\nimport Player from './Player.js';\nimport axios from 'axios';\nimport { processAudioData } from '../utils/processAudio.js'\nimport { submitResponse } from '../utils/submitResponse.js'\nimport { getPitchScatterData, resetCanvas, newPitchChart, newCanvas } from './SoundChart.js';\nimport { getCSRF } from '../utils/csrfHelper'\n\nconst useStyles = makeStyles((theme) => ({\n  content: {\n    justifyContent: \"center\",\n    display: \"flex\"\n  },\n    paper: {\n        padding: theme.spacing(2),\n        flexDirection: \"row\",\n        minWidth: '100vw',\n        minHeight: '80vh',\n        display:\"flex-box\",\n        elevation: 3,\n        alignItems:\"center\"\n    },\n    container: {\n        position: 'relative',\n        height: '100%',\n        justifyContent: \"center\"\n    },\n    button: {\n        position: 'absolute',\n        bottom:'0',\n        right: '0'\n    },\n    grid: {\n        height: \"50%\",\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"100%\"\n    },\n\n    chart: {\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"40%\",\n        marginBottom: \"1vh\",\n        minWidth:\"35vw\",\n    }\n}));\n\nconst ProdTask = (props) => {\n    const classes = useStyles();\n    let [processedData, setProcessedData] = useState(null)\n    let [taskData, setTaskData] = useState()\n\n    let [chartA, setChartA] = useState()\n    let [chartB, setChartB] = useState()\n\n    let responseDataRef = useRef(null);\n    let questionDataRef = useRef(null);\n    \n    let handleAudioChange = (data) => {\n        let newCanvas = resetCanvas('response-data', 'response-data-container', chartB)\n        processAudioData(data).then((response) => { \n            let pitchData = getPitchScatterData(response.data)\n            setChartB(newPitchChart(newCanvas, pitchData, chartB)) // Destroys chart / resets element\n            setProcessedData(pitchData)\n         })\n    }\n\n    let nextTask = () => {\n\n        let response = { 'taskData': taskData, 'responseData': processedData }\n        submitResponse()\n    }\n\n    useEffect(() => {\n        // Update the document title using the browser API (next action... taskType determines the element to show)\n        if (processedData === null) { \n            console.log(\"No changes recorded\") \n        } else {\n        console.log(\"Processed data changed:\", processedData)}\n        },[processedData]);\n\n    useEffect(() => {\n        setChartA(newPitchChart(questionDataRef.current, []))\n        setChartB(newPitchChart(responseDataRef.current, []))\n    },[]);\n\n    return (\n        <div className={classes.content}>\n            <Paper className={classes.paper}>\n                <Grid container className={classes.grid}>\n                    <Grid item>\n                        <Paper id=\"question-data-container\" className={classes.chart}>  \n                            <canvas id=\"question-data\" ref={questionDataRef}></canvas>\n                        </Paper>\n                        <Player url={\"https://intonation-trainer.s3.us-east-2.amazonaws.com/test-audio.mp3\"}></Player>\n                    </Grid>\n                    <Grid item>\n                        <Paper id=\"response-data-container\" className={classes.chart}>\n                            <canvas id=\"response-data\" ref={responseDataRef}></canvas>\n                        </Paper>\n                        <Recorder sets={handleAudioChange} />\n                    </Grid>\n                    <Grid item>\n                        <Button variant=\"outlined\" onClick={nextTask}>Welcome</Button>\n                    </Grid>\n                </Grid>\n            </Paper>\n        </div>\n        );\n    }\n\nexport default withRouter(ProdTask)\n"]},"metadata":{},"sourceType":"module"}
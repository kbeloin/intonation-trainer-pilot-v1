{"ast":null,"code":"var _jsxFileName = \"/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/src/components/pages/ProductionTask.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Container from '@material-ui/core/Container';\nimport { withRouter, NavLink } from 'react-router-dom';\nimport Recorder from './Recorder.js';\nimport Player from './Player.js';\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  content: {\n    justifyContent: \"center\",\n    display: \"flex\"\n  },\n  paper: {\n    padding: theme.spacing(2),\n    flexDirection: \"column\",\n    minWidth: '100vw',\n    minHeight: '80vh',\n    display: \"flex\",\n    elevation: 3,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  container: {\n    position: 'relative',\n    height: '100%',\n    justifyContent: \"center\"\n  },\n  button: {\n    position: 'absolute',\n    bottom: '0',\n    right: '0'\n  },\n  grid: {\n    height: \"50%\",\n    justifyContent: \"space-evenly\",\n    spacing: \"0\",\n    alignItems: \"flex-end\",\n    direction: \"column\",\n    minHeight: \"100%\"\n  }\n}));\n\nconst getCSRF = () => {\n  const token = document.cookie.split('; ').find(row => row.startsWith('csrftoken=')).split('=')[1];\n  return token;\n};\n\nconst uploadFile = (file, s3Data, url) => {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"POST\", s3Data.url);\n  xhr.setRequestHeader(\"X-CSRFToken\", getCSRF());\n  var postData = new FormData();\n  s3Data.fields.forEach(key => postData.append(key, s3Data.fields[key]));\n  postData.append('file', file);\n\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState === 4) {\n      if (xhr.status === 200 || xhr.status === 204) {\n        document.getElementById(\"preview\").src = url;\n        document.getElementById(\"avatar-url\").value = url;\n      } else {\n        alert(\"Could not upload file.\");\n      }\n    }\n  };\n\n  xhr.send(postData);\n};\n\nconst getSignedRequest = file => {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"GET\", \"/sign_s3?file_name=\" + file.name + \"&file_type=\" + file.type);\n  xhr.setRequestHeader(\"X-CSRFToken\", getCSRF());\n\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState === 4) {\n      if (xhr.status === 200) {\n        var response = JSON.parse(xhr.responseText);\n        uploadFile(file, response.data, response.url);\n      } else {\n        alert(\"Could not get signed URL.\");\n      }\n    }\n  };\n\n  xhr.send();\n};\n\nconst processData = data => {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"POST\", \"/api/process/\", true);\n  xhr.setRequestHeader(\"X-CSRFToken\", getCSRF()); //Send the proper header information along with the request\n\n  xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\n  xhr.onreadystatechange = function () {\n    // Call a function when the state changes.\n    if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {// Request finished. Do processing here.\n    }\n  };\n\n  xhr.send(JSON.stringify({\n    'data': data\n  }));\n};\n\nconst ProdTask = props => {\n  _s();\n\n  let [src, setCurrentSrc] = useState();\n  let [staged, setStagedData] = useState();\n  const classes = useStyles();\n  const childRef = useRef(null);\n\n  const handleChange = () => {\n    let audio = staged; // document.getElementById(\"recorder\").currentSrc\n\n    setCurrentSrc(audio); // console.log(src)\n  };\n\n  useEffect(() => {\n    // Update the document title using the browser API\n    src === undefined ? console.log(\"None\") : processData(src);\n  }, [src]);\n  useEffect(() => {\n    // Update the document title using the browser API\n    src === undefined ? console.log(\"None\") : processData(src);\n  }, [src]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.content,\n    children: /*#__PURE__*/_jsxDEV(Paper, {\n      className: classes.paper,\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        className: classes.container,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          className: classes.grid,\n          children: [/*#__PURE__*/_jsxDEV(Player, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Recorder, {\n            forwardedRef: childRef,\n            sets: setStagedData\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outlined\",\n          onClick: handleChange,\n          children: \"Welcome\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 7\n  }, this);\n};\n\n_s(ProdTask, \"T7VaAfeonXPSWDvORGOmZlUFHNQ=\", false, function () {\n  return [useStyles];\n});\n\n_c = ProdTask;\nexport default _c2 = withRouter(ProdTask);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ProdTask\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/kylebeloin/Desktop/intonation_trainer/intonation_trainer/src/components/pages/ProductionTask.js"],"names":["React","useState","useEffect","useRef","makeStyles","Grid","Paper","Button","Typography","Container","withRouter","NavLink","Recorder","Player","axios","useStyles","theme","content","justifyContent","display","paper","padding","spacing","flexDirection","minWidth","minHeight","elevation","alignItems","container","position","height","button","bottom","right","grid","direction","getCSRF","token","document","cookie","split","find","row","startsWith","uploadFile","file","s3Data","url","xhr","XMLHttpRequest","open","setRequestHeader","postData","FormData","fields","forEach","key","append","onreadystatechange","readyState","status","getElementById","src","value","alert","send","getSignedRequest","name","type","response","JSON","parse","responseText","data","processData","DONE","stringify","ProdTask","props","setCurrentSrc","staged","setStagedData","classes","childRef","handleChange","audio","undefined","console","log"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Container from '@material-ui/core/Container'\nimport { withRouter, NavLink } from 'react-router-dom';\nimport Recorder from './Recorder.js'\nimport Player from './Player.js';\nimport axios from \"axios\";\n\nconst useStyles = makeStyles((theme) => ({\n  content: {\n    justifyContent: \"center\",\n    display: \"flex\"\n  },\n    paper: {\n        padding: theme.spacing(2),\n        flexDirection: \"column\",\n        minWidth: '100vw',\n        minHeight: '80vh',\n        display:\"flex\",\n        elevation: 3,\n        justifyContent:\"center\",\n        alignItems:\"center\"\n    },\n    container: {\n        position: 'relative',\n        height: '100%',\n        justifyContent: \"center\"\n    },\n    button: {\n        position: 'absolute',\n        bottom:'0',\n        right: '0'\n    },\n    grid: {\n        height: \"50%\",\n        justifyContent:\"space-evenly\",\n        spacing:\"0\",\n        alignItems:\"flex-end\",\n        direction:\"column\",\n        minHeight:\"100%\"\n    }\n}));\n\nconst getCSRF = () => {\n    const token = document.cookie\n        .split('; ')\n        .find(row => row.startsWith('csrftoken='))\n        .split('=')[1]\n    return token\n}\n\nconst uploadFile = (file, s3Data, url) => {\n    var xhr = new XMLHttpRequest();\n    xhr.open(\"POST\", s3Data.url);\n    xhr.setRequestHeader(\"X-CSRFToken\", getCSRF());\n\n    var postData = new FormData();\n    s3Data.fields.forEach(key =>\n      postData.append(key, s3Data.fields[key]))\n\n    postData.append('file', file);\n  \n    xhr.onreadystatechange = function() {\n      if(xhr.readyState === 4){\n        if(xhr.status === 200 || xhr.status === 204){\n          document.getElementById(\"preview\").src = url;\n          document.getElementById(\"avatar-url\").value = url;\n        }\n        else{\n          alert(\"Could not upload file.\");\n        }\n     }\n    };\n    xhr.send(postData);\n  }\n\n\nconst getSignedRequest = (file) => {\n    \n    var xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", \"/sign_s3?file_name=\"+file.name+\"&file_type=\"+file.type);\n    xhr.setRequestHeader(\"X-CSRFToken\", getCSRF());\n    xhr.onreadystatechange = function(){\n        if(xhr.readyState === 4){\n        if(xhr.status === 200){\n            var response = JSON.parse(xhr.responseText);\n            uploadFile(file, response.data, response.url);\n        }\n        else{\n            alert(\"Could not get signed URL.\");\n        }\n        }\n    };\n    xhr.send();\n    }\n\nconst processData = (data) => {\n    var xhr = new XMLHttpRequest()\n\n    xhr.open(\"POST\", \"/api/process/\", true);\n    xhr.setRequestHeader(\"X-CSRFToken\", getCSRF());\n    //Send the proper header information along with the request\n    xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\n    \n    xhr.onreadystatechange = function() { // Call a function when the state changes.\n        if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n            // Request finished. Do processing here.\n        }\n    }\n    xhr.send(JSON.stringify({'data': data}))\n\n}\n\nconst ProdTask = (props) => {\n    let [src, setCurrentSrc] = useState()\n    let [staged, setStagedData] = useState()\n    const classes = useStyles();\n    const childRef = useRef(null);\n    \n\n    const handleChange = () => {\n        let audio = staged\n        // document.getElementById(\"recorder\").currentSrc\n        setCurrentSrc(audio)     // console.log(src)\n    }\n    \n    useEffect(() => {\n        // Update the document title using the browser API\n        \n        src === undefined ? console.log(\"None\") : processData(src)},[src]);\n    \n    useEffect(() => {\n        // Update the document title using the browser API\n        \n        src === undefined ? console.log(\"None\") : processData(src)},[src]);\n\n    \n    return (\n      <div className={classes.content}>\n        <Paper className={classes.paper}>\n            <Container className={classes.container}>\n                <Grid container className={classes.grid}>\n                    <Player />\n                    <Recorder forwardedRef={childRef} sets={setStagedData}/>\n                    \n                </Grid>\n                    \n                    <Button variant=\"outlined\" onClick={handleChange}>Welcome</Button>\n                    \n            </Container>\n        </Paper>\n        </div>\n        );\n    }\nexport default withRouter(ProdTask)\n"]},"metadata":{},"sourceType":"module"}
(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{125:function(e,t,n){},156:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(31),r=n.n(c),i=(n(125),n(9)),s=n(211),o=n(214),l=n(213),u=n(215),d=n(20),j=n(216),b=n(28),h=n.n(b),f=n(43),p=n(23),O=n.n(p);O.a.defaults.xsrfCookieName="csrftoken",O.a.defaults.xsrfHeaderName="X-CSRFToken";var m=function(){var e=Object(f.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()({method:"get",url:"/api/get-responses/"});case 2:return n=e.sent,console.log(n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(f.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()({method:"post",url:"/api/submit-response/",data:t});case 2:return n=e.sent,console.log("Submitted response"),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=n(218),v=n(217),y=n(222),C=n(229),N=n(227),k=n(228),S=n(226),w=n(2);function R(e){var t=a.useState(!1),n=Object(i.a)(t,2),c=n[0],r=n[1],s=a.useState(""),o=Object(i.a)(s,2),l=o[0],u=o[1],d=function(t){r(!1),e.onSubmit(l)};return Object(w.jsxs)("div",{children:[Object(w.jsx)(g.a,{variant:"outlined",onClick:function(){r(!0)},children:"Enter"}),Object(w.jsxs)(y.a,{open:c,onClose:d,children:[Object(w.jsx)(S.a,{children:"Subscribe"}),Object(w.jsxs)(N.a,{children:[Object(w.jsx)(k.a,{children:"To access the activity, please enter the experiement code here."}),Object(w.jsx)(v.a,{autoFocus:!0,margin:"dense",id:"code",label:"Code",fullWidth:!0,variant:"standard",value:l,onChange:function(e){u(e.target.value)}})]}),Object(w.jsxs)(C.a,{children:[Object(w.jsx)(g.a,{onClick:d,children:"Cancel"}),Object(w.jsx)(g.a,{onClick:d,children:"Submit"})]})]})]})}var D=n(207),H=Object(s.a)((function(e){return{content:{justifyContent:"center",display:"flex"},paper:{padding:e.spacing(2),flexDirection:"column",minWidth:"100vw",minHeight:"80vh",display:"flex",elevation:3,justifyContent:"center",alignItems:"center"},container:{position:"relative",height:"100%",justifyContent:"center"},button:{position:"absolute",bottom:"0",right:"0"},grid:{height:"50%",justifyContent:"center",spacing:"0",alignItems:"center",direction:"column",minHeight:"100%"}}}));O.a.defaults.xsrfCookieName="csrftoken",O.a.defaults.xsrfHeaderName="X-CSRFToken";var I=Object(d.h)((function(e){var t=Object(a.useState)("/"),n=Object(i.a)(t,2),c=(n[0],n[1],Object(a.useState)(!1)),r=Object(i.a)(c,2),s=r[0],b=r[1],h=(Object(a.useRef)(),Object(d.g)()),f=function(){m().then((function(e){var t=e.data;console.log(t.type),h.push("/".concat(t.taskData.type))}))},p=H();return Object(a.useEffect)((function(){O.a.get("/api/get-responses/").then((function(e){var t=e.data;"None"!==t?s||h.push("/".concat(t.taskData.type)):b(!0)}))}),[]),Object(w.jsx)("div",{className:p.content,children:Object(w.jsx)(l.a,{className:p.paper,children:Object(w.jsxs)(o.a,{container:!0,className:p.grid,children:[Object(w.jsx)(o.a,{item:!0,children:Object(w.jsx)(D.a,{in:s,children:Object(w.jsx)(u.a,{variant:"h1",component:"h2",gutterBottom:!0,children:"Welcome"})})}),Object(w.jsx)(o.a,{item:!0,children:Object(w.jsx)(j.a,{className:p.container,children:Object(w.jsx)(R,{onSubmit:function(e){O.a.get("/api/get-responses/").then((function(t){console.log("Checking if user exists..."),"None"===t.data&&O()({method:"post",url:"/api/create-response-set/",data:{code:e}}).then((function(e){return console.log("Created response set for user.")}))})),f()}})})})]})})})})),W=n(219),E=n(230),F={audioBitsPerSecond:16e3};new AudioContext,new FileReader;function B(){return(B=Object(f.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:return t=e.sent,e.abrupt("return",new MediaRecorder(t,F));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),s=Object(i.a)(r,2),o=s[0],l=s[1],u=Object(a.useState)(null),d=Object(i.a)(u,2),j=d[0],b=d[1],h=Object(a.useState)(null),f=Object(i.a)(h,2),p=f[0],O=f[1];Object(a.useEffect)((function(){if(null!==j){o?j.start():j.stop();var e=function(e){var t=new AudioContext,n=new FileReader;n.readAsArrayBuffer(e.data),n.onloadend=function(){console.log("data loaded"),t.decodeAudioData(n.result).then((function(t){console.log(t);var n=t.getChannelData(0);O(n),c(URL.createObjectURL(e.data))}))}};return j.addEventListener("dataavailable",e),function(){return j.removeEventListener("dataavailable",e)}}o&&function(){return B.apply(this,arguments)}().then(b,console.error)}),[j,o]);return[n,o,function(){l(!0)},function(){l(!1)},p]},P=function(e){var t=A(),n=Object(i.a)(t,5),c=n[0],r=n[1],s=n[2],l=n[3],u=n[4];return Object(a.useEffect)((function(){u?(console.log("Raw data ready."),e.sets(u)):console.log("No current audio.")}),[u]),Object(w.jsx)("div",{className:"Recorder",id:"recorder",ref:e.forwardedRef,children:Object(w.jsxs)(o.a,{container:!0,children:[Object(w.jsx)("audio",{src:c,controls:!0}),Object(w.jsx)(W.a,{onClick:s,disabled:r,children:"start"}),Object(w.jsx)(W.a,{onClick:l,disabled:!r,children:"stop"})]})})},T=function(e){return Object(w.jsx)("div",{className:"Player",children:Object(w.jsx)("audio",{controls:!0,src:e.url})})};O.a.defaults.xsrfCookieName="csrftoken",O.a.defaults.xsrfHeaderName="X-CSRFToken";var L=function(){var e=Object(f.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()({method:"post",url:"/api/process/",data:t,headers:{"Content-Type":"application/octet-stream"},transformRequest:[function(e){return JSON.stringify(e)}],transformResponse:[function(e){return JSON.parse(e)}]});case 2:return n=e.sent,console.log("Asychronous response"),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){for(var t=e.x_y||[],n=0;n<t.length;n++)0===t[n].x&&(t[n].x=NaN),0===t[n].y&&(t[n].y=NaN);return t},J=n(17),U=n(59);U.a.register.apply(U.a,Object(J.a)(U.b));var X=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=t.current.getContext("2d");new U.a(n,{type:"scatter",data:{datasets:[{label:"Pitch Frequency",data:e.data,borderWidth:1,backgroundColor:"rgb(255, 99, 132)"}]},options:{scales:{y:{},x:{}}}})}),[]),Object(w.jsx)("canvas",{id:"question-data",ref:t})},_=Object(s.a)((function(e){return{content:{justifyContent:"center",display:"flex"},paper:{padding:e.spacing(2),flexDirection:"row",minWidth:"100vw",minHeight:"80vh",display:"flex-box",elevation:3,alignItems:"center"},container:{position:"relative",height:"100%",justifyContent:"center"},button:{position:"absolute",bottom:"0",right:"0"},grid:{height:"50%",justifyContent:"space-evenly",spacing:"0",alignItems:"flex-end",direction:"column",minHeight:"100%"},chart:{display:"flex",justifyContent:"center",alignItems:"center",direction:"column",minHeight:"40%",marginBottom:"1vh",minWidth:"35vw"}}})),M=Object(d.h)((function(e){var t=_(),n=Object(a.useState)({}),c=Object(i.a)(n,2),r=c[0],s=c[1],u=Object(a.useState)(!0),d=Object(i.a)(u,2),j=(d[0],d[1],Object(a.useState)(!0)),b=Object(i.a)(j,2),h=b[0],f=b[1],p=Object(a.useState)(),O=Object(i.a)(p,2),m=(O[0],O[1],Object(a.useState)()),g=Object(i.a)(m,2);g[0],g[1],Object(a.useRef)(null),Object(a.useRef)(null);return Object(a.useEffect)((function(){null===r?console.log("No changes recorded"):console.log("Processed data changed:",r)}),[r]),Object(w.jsx)("div",{className:t.content,children:Object(w.jsx)(l.a,{className:t.paper,children:Object(w.jsxs)(o.a,{container:!0,className:t.grid,children:[Object(w.jsxs)(o.a,{item:!0,children:[Object(w.jsx)(l.a,{id:"question-data-container",className:t.chart,children:Object(w.jsx)(X,{data:[]})}),Object(w.jsx)(T,{url:"https://intonation-trainer.s3.us-east-2.amazonaws.com/test-audio.mp3"})]}),Object(w.jsxs)(o.a,{item:!0,children:[Object(w.jsx)(l.a,{id:"response-data-container",className:t.chart,children:h?Object(w.jsx)(E.a,{}):Object(w.jsx)(X,{data:r})}),Object(w.jsx)(P,{sets:function(e){!function(e){console.log(h),L(e).then((function(e){var t=q(e.data);s(t),f(!1)}))}(e),f(!0)}})]}),Object(w.jsx)(o.a,{item:!0,children:Object(w.jsx)(W.a,{variant:"outlined",onClick:function(){x()},children:"Welcome"})})]})})})})),z=Object(s.a)((function(e){return{content:{justifyContent:"center",display:"flex"},paper:{padding:e.spacing(2),flexDirection:"row",minWidth:"100vw",minHeight:"80vh",display:"flex-box",elevation:3,alignItems:"center"},container:{position:"relative",height:"100%",justifyContent:"center"},button:{position:"absolute",bottom:"0",right:"0"},grid:{height:"50%",justifyContent:"space-evenly",spacing:"0",alignItems:"flex-end",direction:"column",minHeight:"100%"},chart:{display:"flex",justifyContent:"center",alignItems:"center",direction:"column",minHeight:"40%",marginBottom:"1vh",minWidth:"35vw"}}})),G=Object(d.h)((function(e){var t=z(),n=Object(a.useState)(null),c=Object(i.a)(n,2),r=c[0],s=c[1],u=Object(a.useState)(null),d=Object(i.a)(u,2),j=d[0],b=d[1],h=Object(a.useState)(!1),f=Object(i.a)(h,2),p=f[0],O=f[1];return Object(a.useEffect)((function(){null===r?console.log("No changes recorded"):console.log("Processed data changed:",r),m().then((function(e){console.log(e),b(e.data)}))}),[r]),Object(w.jsx)("div",{className:t.content,children:Object(w.jsx)(l.a,{className:t.paper,children:Object(w.jsxs)(o.a,{container:!0,className:t.grid,children:[Object(w.jsxs)(o.a,{item:!0,children:[Object(w.jsx)(l.a,{id:"question-data-container",className:t.chart,children:j?Object(w.jsx)(X,{data:q(j.taskData.audio)}):Object(w.jsx)(E.a,{})}),Object(w.jsx)(T,{url:j?j.taskData.files[0].filepath:null})]}),Object(w.jsxs)(o.a,{item:!0,children:[Object(w.jsx)(l.a,{id:"response-data-container",className:t.chart,children:p?Object(w.jsx)(E.a,{}):Object(w.jsx)(X,{data:r})}),Object(w.jsx)(P,{sets:function(e){!function(e){L(e).then((function(e){var t=q(e.data);s(t),O(!1)}))}(e),O(!0)}})]}),Object(w.jsx)(o.a,{item:!0,children:Object(w.jsx)(W.a,{variant:"outlined",onClick:function(){!function(){var e={response_id:j.response_id,responseData:r};x(e).then((function(e){return console.log(e)}))}()},children:"Welcome"})})]})})})})),K=n(47),Q=Object(s.a)((function(e){return{content:{justifyContent:"center",display:"flex"},paper:{padding:e.spacing(2),flexDirection:"column",minWidth:"100vw",minHeight:"80vh",display:"flex",elevation:3,justifyContent:"center",alignItems:"center"},container:{position:"relative",height:"100%",justifyContent:"center"},button:{position:"absolute",bottom:"0",right:"0"},grid:{height:"50%",justifyContent:"center",spacing:"0",alignItems:"center",direction:"column",minHeight:"100%"}}})),V=Object(d.h)((function(e){var t=Q();return Object(w.jsx)("div",{className:t.content,children:Object(w.jsxs)(l.a,{className:t.paper,children:[Object(w.jsx)(o.a,{container:!0,className:t.grid,children:Object(w.jsx)(u.a,{variant:"h1",component:"h2",gutterBottom:!0,children:"Welcome"})}),Object(w.jsx)(j.a,{className:t.container,children:Object(w.jsx)(K.a,{className:t.button,to:"/production-task",style:{textDecoration:"none"},children:Object(w.jsx)(W.a,{variant:"outlined",children:"Enter"})},"")})]})})}));function Y(){return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.d,{children:[Object(w.jsx)(d.b,{exact:!0,path:"/",component:I}),Object(w.jsx)(d.b,{path:"/production-matching",component:G}),Object(w.jsx)(d.b,{path:"/perception-task",component:M}),Object(w.jsx)(d.b,{exact:!0,path:"/done",component:V})]})})})}var Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,232)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};r.a.render(Object(w.jsx)(Y,{}),document.getElementById("root")),Z()}},[[156,1,2]]]);
//# sourceMappingURL=main.e33c9b83.chunk.js.map